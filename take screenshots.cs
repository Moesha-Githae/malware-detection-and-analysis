private void button2_Click(object sender, EventArgs e)
{
ScreenCapture sc = new ScreenCapture();
// capture entire screen, and save it to a file Image img = sc.CaptureScreen();
Bitmap b = new Bitmap(img);
string filename = DateTime.Now.Year.ToString() + DateTime.Now.Month.ToString()	+	DateTime.Now.Day.ToString()	+ DateTime.Now.Hour.ToString() +
DateTime.Now.Minute.ToString()	+ DateTime.Now.Second.ToString() + DateTime.Now.Millisecond.ToString() + ".jpg";
b.Save(AppDomain.CurrentDomain.BaseDirectory	+	"reports\\"	+ StaticValues.UserName + "\\" + txtTitle.Text + "\\" + filename);
//	capture	this	window,	and	save	it	- http://stackoverflow.com/questions/1163761/capture-screenshot-of-active-window
ENTITIES.ScanScreenShot sss = new ENTITIES.ScanScreenShot(); sss.ExecutionLogId = StaticValues.ExecutionLogId;
sss.Image = filename; sss.CreatedDate = DateTime.Now;
new ExecutionComponent().SaveScreenShot(sss);
}